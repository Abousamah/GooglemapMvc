@{
    ViewBag.Title = "Marker Client Events";
    Layout = "~/Views/Shared/_LayoutExamples.cshtml";
}

<style>
    .event {
        transition: background-color 0.5s ease-out;
        padding-bottom: 2px;
    }

    .event.active {
        background-color: #99CCFF;
    }

    .event.inactive {
        background-color: transparent;
    }
</style>

<div id="main" class="row">
    <div class="col-md-10">
        @(Html.GoogleMap()
              .Name("map")
              .Height(420)
              .Markers(m =>
              {
                  m.Add().Title("Hello World!").Longitude(-82)
                      .Latitude(23);
                  m.Add().Title("Hola Mundo").Longitude(-81.9)
                      .Latitude(22.9);
              })
              .MarkerEvents(events =>
                    events.OnMarkerClick("highlightEvent")
                        .OnMarkerDragStart("highlightEvent")
                        .OnMarkerDrag("highlightEvent")
                        .OnMarkerDragEnd("highlightEvent")
                )
          )
    </div>
    <div id="events" class="col-md-2">
    </div>
</div>

@section Scripts{

    <script type="text/javascript">

        $(document).ready(function() {

            var events = [
                'click'
            ];

            // Dynamically create the table of events from the defined hashmap
            function populateTable() {
                var eventsTable = document.getElementById('events');
                var content = '';
                for (var i = 0; i < events.length; i++) {
                    content += '<div class="event" id="' + events[i] + '">' + events[i] + '</div>';
                }
                eventsTable.innerHTML = content;
            }

            populateTable();
        });


        function highlightEvent(args) {
            var timeout;
            var eventRow = document.getElementById(args.eventName);
            eventRow.className = 'event active';
            clearTimeout(timeout);
            setTimeout(function() {
                eventRow.className = 'event inactive';
            }, 1000);
            if (args.eventName === 'click') {
                //TODO: do somethig with the marker
            }
        }

    </script>
}